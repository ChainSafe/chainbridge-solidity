# Copyright 2020 ChainSafe Systems
# SPDX-License-Identifier: LGPL-3.0-only

language: node_js
node_js: 12

env:
  global:
    - GO111MODULE=on

cache: npm

jobs:
  include:
    - name: "Run Truffle tests"
      env: CI=true
      script:
        - make install-deps
        - make test
    - name: "Verify contract deployment and binding creation"
      env: CI=true
      script:
        - make install-deps && make install-cli
        - make bindings
        - SILENT=true make start-ganache
        - cb-sol-cli deploy -v 1
        - cb-sol-cli mint
        - cb-sol-cli transfer
        - cb-sol-cli sendCentHash --hash 0x736f796c656e745f677265656e5f69735f70656f706c65
        - cb-sol-cli getCentHash --hash 0x736f796c656e745f677265656e5f69735f70656f706c65
